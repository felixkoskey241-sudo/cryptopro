<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoPro - Professional Crypto Trading Platform</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a1628 0%, #1e3a5f 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.8; } }
        @keyframes slideLeft { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 20px rgba(0,255,136,0.3); } 50% { box-shadow: 0 0 40px rgba(0,255,136,0.6); } }
        @keyframes shine { 0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); } 100% { transform: translateX(100%) translateY(100%) rotate(45deg); } }
        @keyframes slideInUp { from { transform: translateY(100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .layer { display: none; min-height: 100vh; animation: fadeIn 0.5s ease-out; }
        .layer.active { display: block; }
        .bonus-banner {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            padding: 20px; text-align: center; margin-bottom: 20px;
            border-radius: 16px; position: relative; overflow: hidden; animation: glow 2s infinite;
        }
        .bonus-banner::before {
            content: ''; position: absolute; top: -50%; left: -50%;
            width: 200%; height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shine 3s infinite;
        }
        .bonus-banner h2 { font-size: 28px; color: #000; margin-bottom: 8px; font-weight: 900; position: relative; z-index: 1; }
        .bonus-banner p { font-size: 16px; color: rgba(0,0,0,0.8); position: relative; z-index: 1; }
        .bonus-amount { font-size: 48px; font-weight: 900; color: #000; margin: 12px 0; }
        .winners-ticker {
            background: rgba(20,35,60,0.9); padding: 16px 0; margin-bottom: 24px;
            overflow: hidden; border-radius: 12px; border: 2px solid rgba(0,255,136,0.3);
        }
        .winners-ticker-title { text-align: center; color: #00ff88; font-size: 14px; font-weight: 700; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1px; }
        .ticker-wrap { overflow: hidden; }
        .ticker-content { display: flex; animation: slideLeft 120s linear infinite; white-space: nowrap; width: max-content; }
        .winner-item {
            display: inline-flex; align-items: center; gap: 12px;
            padding: 8px 24px; background: rgba(0,255,136,0.1);
            border-radius: 20px; margin-right: 16px; border: 1px solid rgba(0,255,136,0.2);
        }
        .winner-item .amount { color: #00ff88; font-weight: 700; }
        .navbar {
            background: rgba(20,35,60,0.95); backdrop-filter: blur(10px);
            padding: 16px 20px; display: flex; justify-content: space-between;
            align-items: center; position: sticky; top: 0; z-index: 1000;
            border-bottom: 1px solid rgba(0,217,255,0.2);
        }
        .logo { display: flex; align-items: center; gap: 12px; font-size: 24px; font-weight: 700; color: #00d9ff; cursor: pointer; }
        .nav-links { display: flex; gap: 20px; align-items: center; }
        .nav-btn { padding: 10px 20px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s; font-size: 14px; }
        .btn-login { background: transparent; color: #00d9ff; border: 2px solid #00d9ff; }
        .btn-signup { background: linear-gradient(135deg, #00d9ff, #0099cc); color: #fff; border: none; }
        .btn-login:hover, .btn-signup:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(0,217,255,0.4); }
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        .hero { text-align: center; padding: 60px 20px 40px; background: rgba(0,0,0,0.2); border-radius: 24px; margin-bottom: 30px; }
        .hero h1 { font-size: 42px; margin-bottom: 16px; background: linear-gradient(135deg, #00d9ff, #a855f7); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .hero p { font-size: 18px; color: rgba(255,255,255,0.8); margin-bottom: 30px; line-height: 1.6; }
        .cta-buttons { display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; }
        .btn-large { padding: 16px 32px; font-size: 18px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; border: none; }
        .btn-primary { background: linear-gradient(135deg, #00d9ff, #0099cc); color: #fff; }
        .btn-secondary { background: transparent; color: #00d9ff; border: 2px solid #00d9ff; }
        .btn-large:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0,217,255,0.4); }
        .stats-grid { display: flex; justify-content: space-around; background: rgba(0,217,255,0.1); border-radius: 16px; padding: 16px; margin-bottom: 24px; flex-wrap: wrap; }
        .stat { text-align: center; margin: 8px; }
        .stat-value { font-size: 24px; font-weight: 700; color: #00d9ff; }
        .stat-label { font-size: 12px; color: rgba(255,255,255,0.7); text-transform: uppercase; }
        .card { background: rgba(20,35,60,0.9); border-radius: 24px; padding: 30px; margin-bottom: 24px; box-shadow: 0 8px 20px rgba(0,0,0,0.4); }
        .section-title { color: #00d9ff; margin-bottom: 16px; font-size: 20px; }
        .simple-crypto-card { display: flex; justify-content: space-between; align-items: center; background: rgba(10,25,45,0.6); border-radius: 16px; padding: 16px; margin-bottom: 12px; transition: all 0.3s; }
        .simple-crypto-card:hover { background: rgba(10,25,45,0.8); transform: translateX(5px); }
        .crypto-info { display: flex; align-items: center; gap: 12px; }
        .crypto-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: bold; }
        .crypto-name { font-weight: 600; font-size: 16px; }
        .crypto-price { font-size: 18px; font-weight: 700; }
        .asset-change { padding: 4px 8px; border-radius: 6px; font-size: 13px; font-weight: 600; }
        .positive { color: #00ff88; background: rgba(0,255,136,0.1); }
        .negative { color: #ff006e; background: rgba(255,0,110,0.1); }
        /* Charts */
        .trading-card { background: rgba(10,25,45,0.95); border-radius: 16px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(0,217,255,0.2); transition: all 0.3s; }
        .trading-card:hover { border-color: #00d9ff; box-shadow: 0 4px 20px rgba(0,217,255,0.2); }
        .trading-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .pair-info { display: flex; align-items: center; gap: 12px; }
        .price-info { text-align: right; }
        .current-price { font-size: 24px; font-weight: 900; }
        .price-change { font-size: 14px; margin-top: 4px; }
        .chart-wrapper { position: relative; height: 220px; background: #0d1b2e; border-radius: 12px; overflow: hidden; margin-bottom: 8px; border: 1px solid rgba(255,255,255,0.06); }
        .chart-grid-lines { position: absolute; inset: 0; display: flex; flex-direction: column; justify-content: space-between; padding: 10px 60px 28px 10px; pointer-events: none; }
        .chart-h-line { height: 1px; background: rgba(255,255,255,0.05); width: 100%; }
        .chart-v-lines { position: absolute; inset: 0; display: flex; justify-content: space-between; padding: 10px 60px 28px 10px; pointer-events: none; }
        .chart-v-line { width: 1px; background: rgba(255,255,255,0.05); height: 100%; }
        .price-axis { position: absolute; right: 0; top: 0; bottom: 28px; width: 58px; display: flex; flex-direction: column; justify-content: space-between; padding: 10px 4px; font-size: 10px; color: rgba(255,255,255,0.45); text-align: right; }
        .time-axis { position: absolute; bottom: 0; left: 10px; right: 60px; height: 26px; display: flex; justify-content: space-between; align-items: center; font-size: 10px; color: rgba(255,255,255,0.4); padding: 0 4px; }
        .candles-area { position: absolute; top: 10px; left: 10px; right: 60px; bottom: 28px; display: flex; align-items: flex-end; gap: 2px; }
        .candle { flex: 1; display: flex; flex-direction: column; align-items: center; cursor: pointer; }
        .candle-wick-top { width: 1.5px; }
        .candle-body { width: 80%; border-radius: 1px; min-height: 3px; }
        .candle-wick-bot { width: 1.5px; }
        .bull .candle-wick-top, .bull .candle-wick-bot { background: #00cc6a; }
        .bull .candle-body { background: #00ff88; border: 1px solid #00cc6a; }
        .bear .candle-wick-top, .bear .candle-wick-bot { background: #cc0055; }
        .bear .candle-body { background: #ff006e; border: 1px solid #cc0055; }
        .profit-tag { position: absolute; top: 8px; left: 10px; background: rgba(0,255,136,0.15); border: 1px solid rgba(0,255,136,0.4); padding: 5px 10px; border-radius: 8px; font-size: 13px; font-weight: 700; color: #00ff88; }
        .profit-tag.neg { background: rgba(255,0,110,0.15); border-color: rgba(255,0,110,0.4); color: #ff006e; }
        .vol-section { margin-top: 4px; }
        .vol-label { font-size: 10px; color: rgba(255,255,255,0.4); text-transform: uppercase; letter-spacing: .5px; margin-bottom: 3px; }
        .vol-bars { display: flex; align-items: flex-end; gap: 2px; height: 44px; background: rgba(0,0,0,0.2); border-radius: 6px; padding: 6px; }
        .vol-bar { flex: 1; border-radius: 2px 2px 0 0; min-height: 2px; }
        .vol-bar.bull { background: rgba(0,255,136,0.45); }
        .vol-bar.bear { background: rgba(255,0,110,0.45); }
        .trade-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 12px; }
        .tbtn { padding: 13px; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; transition: all .3s; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 6px; }
        .tbtn:hover { transform: translateY(-2px); box-shadow: 0 5px 14px rgba(0,0,0,0.4); }
        .tbtn-buy { background: linear-gradient(135deg,#00ff88,#00cc6a); color: #000; }
        .tbtn-sell { background: linear-gradient(135deg,#ff006e,#cc0055); color: #fff; }
        /* Auth */
        .auth-container { max-width: 480px; margin: 60px auto; padding: 40px; background: rgba(20,35,60,0.95); border-radius: 24px; box-shadow: 0 8px 32px rgba(0,0,0,0.6); border: 1px solid rgba(0,217,255,0.2); }
        .auth-logo { text-align: center; margin-bottom: 32px; }
        .auth-logo-icon { font-size: 60px; margin-bottom: 12px; animation: pulse 2s infinite; display: block; }
        .auth-logo-text { font-size: 32px; font-weight: 900; background: linear-gradient(135deg,#00d9ff,#a855f7); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .auth-title { text-align: center; margin-bottom: 24px; font-size: 24px; color: #00d9ff; }
        .form-group { margin-bottom: 18px; }
        .form-group label { display: block; margin-bottom: 7px; font-size: 14px; font-weight: 600; color: rgba(255,255,255,0.9); }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 13px 16px; border: 2px solid rgba(0,217,255,0.3); border-radius: 12px; background: rgba(10,25,45,0.6); color: #fff; font-size: 15px; transition: all .3s; font-family: inherit; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #00d9ff; box-shadow: 0 0 0 3px rgba(0,217,255,0.1); }
        .form-group input::placeholder { color: rgba(255,255,255,0.4); }
        .form-group select option { background: #1a2a4a; color: #fff; }
        .btn-submit { width: 100%; padding: 15px; border: none; border-radius: 12px; background: linear-gradient(135deg,#00d9ff,#0099cc); color: #fff; font-size: 17px; font-weight: 700; cursor: pointer; transition: all .3s; margin-top: 8px; }
        .btn-submit:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,217,255,0.4); }
        .btn-submit:disabled { opacity: 0.55; cursor: not-allowed; transform: none; }
        .auth-divider { text-align: center; margin: 22px 0; position: relative; }
        .auth-divider::before { content: ''; position: absolute; left: 0; top: 50%; width: 100%; height: 1px; background: rgba(255,255,255,0.2); }
        .auth-divider span { background: rgba(20,35,60,0.95); padding: 0 12px; position: relative; font-size: 14px; color: rgba(255,255,255,0.6); }
        .auth-link { text-align: center; font-size: 14px; color: rgba(255,255,255,0.8); }
        .auth-link a { color: #00d9ff; text-decoration: none; font-weight: 600; cursor: pointer; }
        .auth-link a:hover { text-decoration: underline; }
        .alert { padding: 12px 16px; border-radius: 8px; margin-bottom: 18px; font-size: 14px; display: none; }
        .alert.show { display: block; }
        .alert-success { background: rgba(0,255,136,0.1); border: 1px solid rgba(0,255,136,0.3); color: #00ff88; }
        .alert-error { background: rgba(255,0,110,0.1); border: 1px solid rgba(255,0,110,0.3); color: #ff006e; }
        .checkbox-group { display: flex; align-items: center; gap: 8px; margin-bottom: 18px; }
        .checkbox-group input[type="checkbox"] { width: 18px; height: 18px; cursor: pointer; accent-color: #00d9ff; }
        .checkbox-group label { font-size: 13px; color: rgba(255,255,255,0.8); cursor: pointer; }
        /* Dashboard */
        .dashboard-header { background: rgba(20,35,60,0.95); padding: 20px; border-radius: 16px; margin-bottom: 24px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px; }
        .user-info { display: flex; align-items: center; gap: 12px; }
        .user-avatar { width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg,#00d9ff,#a855f7); display: flex; align-items: center; justify-content: center; font-size: 22px; }
        .account-toggle { display: flex; gap: 12px; }
        .toggle-btn { padding: 10px 20px; border: 2px solid rgba(0,217,255,0.3); border-radius: 8px; background: transparent; color: rgba(255,255,255,0.7); cursor: pointer; transition: all .3s; font-weight: 600; }
        .toggle-btn.active { background: linear-gradient(135deg,#00d9ff,#0099cc); color: #fff; border-color: transparent; }
        .balance-display { background: linear-gradient(135deg,#00ff88,#00d9ff); padding: 32px; border-radius: 20px; margin-bottom: 24px; text-align: center; box-shadow: 0 8px 32px rgba(0,255,136,0.3); }
        .balance-amount { font-size: 48px; font-weight: 900; color: #0a1628; margin-bottom: 8px; }
        .balance-label { color: rgba(10,22,40,0.8); font-size: 14px; font-weight: 600; text-transform: uppercase; }
        .action-grid { display: grid; grid-template-columns: repeat(auto-fit,minmax(180px,1fr)); gap: 16px; margin-bottom: 24px; }
        .action-btn { padding: 20px; border: none; border-radius: 16px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all .3s; text-align: center; }
        .action-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0,0,0,0.3); }
        .btn-trade { background: linear-gradient(135deg,#fbbf24,#f59e0b); color: #000; }
        .btn-bot { background: linear-gradient(135deg,#a855f7,#7c3aed); color: #fff; }
        .btn-deposit { background: linear-gradient(135deg,#00d9ff,#0099cc); color: #fff; }
        .btn-withdraw { background: linear-gradient(135deg,#ff006e,#cc0055); color: #fff; }
        .btn-logout { background: rgba(255,255,255,0.1); color: #fff; padding: 10px 20px; border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; cursor: pointer; transition: all .3s; }
        .btn-logout:hover { background: rgba(255,0,110,0.2); border-color: #ff006e; }
        /* Modal */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(8px); z-index: 2000; align-items: center; justify-content: center; padding: 20px; overflow-y: auto; }
        .modal.active { display: flex; }
        .modal-content { background: linear-gradient(135deg,#1a1f3a 0%,#0a0e27 100%); border-radius: 24px; padding: 32px; max-width: 580px; width: 100%; max-height: 92vh; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .modal-title { font-size: 22px; color: #00ff88; }
        .close-btn { background: rgba(255,255,255,0.1); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; transition: all .3s; line-height: 1; }
        .close-btn:hover { background: rgba(255,255,255,0.2); transform: rotate(90deg); }
        /* Payment method grid */
        .pay-methods { display: grid; grid-template-columns: repeat(2,1fr); gap: 12px; margin: 4px 0 16px; }
        .pay-card { background: rgba(10,25,45,0.6); border: 2px solid rgba(100,200,255,0.2); padding: 16px 12px; border-radius: 12px; cursor: pointer; transition: all .3s; text-align: center; }
        .pay-card:hover { border-color: #00d9ff; background: rgba(10,25,45,0.85); }
        .pay-card.chosen { background: rgba(0,255,136,0.15); border-color: #00ff88; }
        .pay-icon { font-size: 30px; margin-bottom: 6px; }
        .pay-name { font-size: 13px; font-weight: 700; }
        /* Payment detail box (hidden until method chosen) */
        .pay-detail-box { background: rgba(0,255,136,0.08); border: 2px solid rgba(0,255,136,0.3); border-radius: 12px; padding: 16px; margin-bottom: 16px; display: none; }
        .pay-detail-box.visible { display: block; }
        .pay-instruction { font-size: 13px; color: rgba(255,255,255,0.85); line-height: 1.6; margin-bottom: 10px; }
        .pay-address { font-size: 14px; font-weight: 700; color: #00ff88; word-break: break-all; background: rgba(0,0,0,0.3); padding: 10px 12px; border-radius: 8px; margin-bottom: 6px; }
        .pay-note { font-size: 11px; color: rgba(255,255,255,0.5); margin-top: 6px; }
        .warn-box { background: rgba(255,0,110,0.08); border: 2px solid rgba(255,0,110,0.3); border-radius: 12px; padding: 14px; margin: 14px 0; }
        .warn-box strong { color: #ff006e; display: block; margin-bottom: 6px; }
        .warn-box p { font-size: 13px; line-height: 1.7; }
        /* Bot cards */
        .bot-card { background: rgba(10,25,45,0.6); border: 2px solid rgba(100,200,255,0.2); padding: 18px; border-radius: 16px; margin-bottom: 14px; cursor: pointer; transition: all .3s; }
        .bot-card:hover { border-color: #00d9ff; transform: translateY(-2px); }
        .bot-card.selected { background: rgba(0,255,136,0.15); border-color: #00ff88; }
        /* Live panel */
        #livePanel { position: fixed; bottom: 20px; right: 20px; width: 330px; max-height: 480px; background: rgba(20,35,60,0.98); border: 2px solid rgba(0,217,255,0.3); border-radius: 16px; padding: 18px; z-index: 998; overflow-y: auto; display: none; box-shadow: 0 8px 32px rgba(0,0,0,0.6); }
        #livePanel.show { display: block; animation: slideInUp .5s ease-out; }
        .trade-item { background: rgba(10,25,45,0.6); border-left: 3px solid; padding: 10px; border-radius: 8px; margin-bottom: 8px; transition: all .3s; }
        .trade-item:hover { background: rgba(10,25,45,0.9); transform: translateX(4px); }
        @media(max-width:768px) {
            .hero h1 { font-size: 26px; }
            .cta-buttons { flex-direction: column; }
            .dashboard-header { flex-direction: column; }
            .balance-amount { font-size: 34px; }
            #livePanel { width: calc(100% - 32px); bottom: 8px; right: 8px; }
            .nav-links { gap: 8px; }
            .nav-btn { padding: 7px 13px; font-size: 12px; }
            .pay-methods { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body>

<!-- LAYER 1: WELCOME -->
<div id="welcomeLayer" class="layer active">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('welcomeLayer')"><span style="font-size:28px">üíé</span><span>CryptoPro</span></div>
        <div class="nav-links">
            <button class="nav-btn btn-login" onclick="showLayer('loginLayer')">Login</button>
            <button class="nav-btn btn-signup" onclick="showLayer('signupLayer')">Sign Up</button>
        </div>
    </nav>
    <div class="container">
        <div class="bonus-banner">
            <h2>üéâ WELCOME BONUS üéâ</h2>
            <div class="bonus-amount">100% MATCH</div>
            <p><strong>Get 100% bonus on your first deposit!</strong><br>Deposit $100, Get $200 to trade!</p>
        </div>
        <div class="winners-ticker">
            <div class="winners-ticker-title">üèÜ LIVE WINNERS ‚Äì REAL-TIME PROFITS üèÜ</div>
            <div class="ticker-wrap"><div class="ticker-content" id="winnersTicker"></div></div>
        </div>
        <div class="hero">
            <h1>Professional Crypto Trading Platform</h1>
            <p>Join <strong id="heroUsers">50,123</strong> investors earning daily profits through AI-powered trading bots. Over $125M in profits paid!</p>
            <div class="cta-buttons">
                <button class="btn-large btn-primary" onclick="showLayer('signupLayer')">üöÄ Start Trading Now</button>
                <button class="btn-large btn-secondary" onclick="showLayer('loginLayer')">üîê Login to Dashboard</button>
            </div>
        </div>
        <div class="stats-grid">
            <div class="stat"><div class="stat-value" id="statsUsers">50,123</div><div class="stat-label">Active Traders</div></div>
            <div class="stat"><div class="stat-value">$125.7M</div><div class="stat-label">Total Profits</div></div>
            <div class="stat"><div class="stat-value">10+</div><div class="stat-label">Years Trusted</div></div>
            <div class="stat"><div class="stat-value">98.5%</div><div class="stat-label">Success Rate</div></div>
        </div>
        <div class="card">
            <h2 class="section-title">üìä Live Crypto Markets</h2>
            <div id="marketsContainer"></div>
        </div>
    </div>
</div>

<!-- LAYER 2: SIGN UP -->
<div id="signupLayer" class="layer">
    <div class="auth-container">
        <div class="auth-logo"><span class="auth-logo-icon">üíé</span><div class="auth-logo-text">CryptoPro</div></div>
        <h2 class="auth-title">Create Your Account</h2>
        <div id="signupAlert" class="alert"></div>
        <form id="signupForm">
            <div class="form-group"><label>Full Name</label><input type="text" id="signupName" placeholder="Enter your full name" required></div>
            <div class="form-group"><label>Email Address</label><input type="email" id="signupEmail" placeholder="your@email.com" required></div>
            <div class="form-group"><label>Phone Number</label><input type="tel" id="signupPhone" placeholder="+1 234 567 8900" required></div>
            <div class="form-group"><label>Password</label><input type="password" id="signupPassword" placeholder="Min 6 characters" required></div>
            <div class="form-group"><label>Confirm Password</label><input type="password" id="signupConfirm" placeholder="Re-enter password" required></div>
            <div class="checkbox-group">
                <input type="checkbox" id="signupTerms" required>
                <label for="signupTerms">I agree to Terms &amp; Conditions</label>
            </div>
            <button type="submit" class="btn-submit" id="signupBtn">üöÄ Create Account</button>
        </form>
        <div class="auth-divider"><span>Already have an account?</span></div>
        <div class="auth-link"><a onclick="showLayer('loginLayer')">Login Here</a></div>
        <div class="auth-link" style="margin-top:12px"><a onclick="showLayer('welcomeLayer')" style="color:rgba(255,255,255,0.5)">‚Üê Back to Home</a></div>
    </div>
</div>

<!-- LAYER 3: LOGIN -->
<div id="loginLayer" class="layer">
    <div class="auth-container">
        <div class="auth-logo"><span class="auth-logo-icon">üíé</span><div class="auth-logo-text">CryptoPro</div></div>
        <h2 class="auth-title">Welcome Back</h2>
        <div id="loginAlert" class="alert"></div>
        <form id="loginForm">
            <div class="form-group"><label>Email Address</label><input type="email" id="loginEmail" placeholder="your@email.com" required></div>
            <div class="form-group"><label>Password</label><input type="password" id="loginPassword" placeholder="Your password" required></div>
            <div class="checkbox-group">
                <input type="checkbox" id="loginRemember">
                <label for="loginRemember">Remember me</label>
            </div>
            <button type="submit" class="btn-submit">üîê Login</button>
        </form>
        <div class="auth-divider"><span>Don't have an account?</span></div>
        <div class="auth-link"><a onclick="showLayer('signupLayer')">Create Account</a></div>
        <div class="auth-link" style="margin-top:12px"><a onclick="showLayer('welcomeLayer')" style="color:rgba(255,255,255,0.5)">‚Üê Back to Home</a></div>
    </div>
</div>

<!-- LAYER 4: DASHBOARD -->
<div id="dashboardLayer" class="layer">
    <nav class="navbar">
        <div class="logo"><span style="font-size:28px">üíé</span><span>CryptoPro</span></div>
        <button class="btn-logout" onclick="handleLogout()">Logout</button>
    </nav>
    <div class="container">
        <div class="dashboard-header">
            <div class="user-info">
                <div class="user-avatar">üë§</div>
                <div>
                    <div style="font-size:16px;font-weight:600" id="userName">User</div>
                    <div style="font-size:12px;opacity:.7" id="userEmail">email@example.com</div>
                </div>
            </div>
            <div class="account-toggle">
                <button class="toggle-btn" id="demoBtn" onclick="switchAccount('demo')">üéÆ DEMO</button>
                <button class="toggle-btn active" id="realBtn" onclick="switchAccount('real')">üí∞ REAL</button>
            </div>
        </div>
        <div class="balance-display">
            <div class="balance-label">TOTAL PORTFOLIO VALUE</div>
            <div class="balance-amount" id="dashBalance">$0.00</div>
        </div>
        <div class="action-grid">
            <button class="action-btn btn-trade" onclick="showModal('tradeModal')">‚ö° TRADE NOW</button>
            <button class="action-btn btn-bot" onclick="showModal('botModal')">ü§ñ TRADING BOT</button>
            <button class="action-btn btn-deposit" onclick="showModal('depositModal')">üí∞ DEPOSIT</button>
            <button class="action-btn btn-withdraw" onclick="showModal('withdrawModal')">üí∏ WITHDRAW</button>
        </div>
        <div class="card">
            <h2 class="section-title">üìä Live Trading Charts</h2>
            <div id="dashMarkets"></div>
        </div>
    </div>
</div>

<!-- DEPOSIT MODAL -->
<div id="depositModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">üí∞ Deposit Funds</h2>
            <button class="close-btn" onclick="closeModal('depositModal')">√ó</button>
        </div>
        <div style="background:rgba(251,191,36,.1);border:2px solid rgba(251,191,36,.3);border-radius:12px;padding:14px;margin-bottom:18px;text-align:center">
            <div style="font-size:20px;font-weight:900;color:#fbbf24;margin-bottom:6px">üéâ 100% WELCOME BONUS!</div>
            <div style="font-size:13px;color:rgba(255,255,255,.9)">First deposit gets 100% match!</div>
        </div>
        <div class="form-group">
            <label>Amount (USD)</label>
            <input type="number" id="depositAmount" min="10" placeholder="Minimum $10">
        </div>
        <div class="form-group" style="margin-bottom:8px">
            <label>Choose Payment Method</label>
        </div>
        <div class="pay-methods">
            <div class="pay-card" onclick="choosePayment('crypto',this)"><div class="pay-icon">ü™ô</div><div class="pay-name">Crypto (USDT)</div></div>
            <div class="pay-card" onclick="choosePayment('mpesa',this)"><div class="pay-icon">üì±</div><div class="pay-name">M-Pesa</div></div>
            <div class="pay-card" onclick="choosePayment('card',this)"><div class="pay-icon">üí≥</div><div class="pay-name">Card</div></div>
            <div class="pay-card" onclick="choosePayment('bank',this)"><div class="pay-icon">üè¶</div><div class="pay-name">Bank Transfer</div></div>
        </div>
        <!-- Payment details: hidden until method selected -->
        <div id="payDetailBox" class="pay-detail-box">
            <div class="pay-instruction" id="payInstruction"></div>
            <div class="pay-address" id="payAddress"></div>
            <div class="pay-note" id="payNote"></div>
        </div>
        <div class="warn-box">
            <strong>‚ö†Ô∏è IMPORTANT</strong>
            <p>‚Ä¢ Complete your payment FIRST, then enter the reference below<br>
            ‚Ä¢ Funds credited automatically within 1‚Äì5 minutes<br>
            ‚Ä¢ If not received after 5 minutes, upload your screenshot below</p>
        </div>
        <div class="form-group">
            <label>Transaction Reference <span style="color:#ff006e">*</span></label>
            <input type="text" id="depositRef" placeholder="Enter your transaction ID / reference">
        </div>
        <div class="form-group">
            <label>Payment Screenshot (if delayed &gt; 5 min)</label>
            <textarea id="depositProof" rows="2" placeholder="Paste screenshot link here‚Ä¶"></textarea>
        </div>
        <button class="btn-submit" id="depositSubmitBtn" onclick="processDeposit()" disabled>‚ö° CONFIRM DEPOSIT</button>
        <p style="text-align:center;margin-top:12px;font-size:12px;opacity:.6">Funds appear automatically after verification (1‚Äì5 min)</p>
    </div>
</div>

<!-- WITHDRAW MODAL -->
<div id="withdrawModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">üí∏ Withdraw Funds</h2>
            <button class="close-btn" onclick="closeModal('withdrawModal')">√ó</button>
        </div>
        <div class="form-group"><label>Amount (USD)</label><input type="number" id="withdrawAmount" min="10" placeholder="Minimum $10"></div>
        <div class="form-group"><label>Withdrawal Method</label>
            <select id="withdrawMethod">
                <option>üè¶ Bank Transfer</option>
                <option>ü™ô Crypto</option>
                <option>üì± M-Pesa</option>
            </select>
        </div>
        <div class="form-group"><label>Account Details</label><input type="text" id="withdrawAccount" placeholder="Enter account/wallet details"></div>
        <button class="btn-submit" onclick="processWithdraw()">üí∏ REQUEST WITHDRAWAL</button>
    </div>
</div>

<!-- TRADE MODAL -->
<div id="tradeModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">üìä Execute Trade</h2>
            <button class="close-btn" onclick="closeModal('tradeModal')">√ó</button>
        </div>
        <div class="form-group"><label>Trading Pair</label>
            <select id="tradePair">
                <option>BTC/USDT</option><option>ETH/USDT</option><option>SOL/USDT</option><option>BNB/USDT</option>
            </select>
        </div>
        <div class="form-group"><label>Trade Type</label>
            <select id="tradeType"><option>üü¢ BUY (Long)</option><option>üî¥ SELL (Short)</option></select>
        </div>
        <div class="form-group"><label>Amount (USD)</label><input type="number" id="tradeAmount" min="10" placeholder="Minimum $10"></div>
        <button class="btn-submit" onclick="executeTrade()">‚ö° EXECUTE TRADE</button>
    </div>
</div>

<!-- BOT MODAL -->
<div id="botModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">ü§ñ AI Trading Bots</h2>
            <button class="close-btn" onclick="closeModal('botModal')">√ó</button>
        </div>
        <div class="bot-card" onclick="selectBot(this,'conservative')">
            <div style="display:flex;gap:14px;align-items:center">
                <span style="font-size:32px">üõ°Ô∏è</span>
                <div><div style="font-size:17px;font-weight:700;margin-bottom:3px">Conservative Bot</div>
                <div style="font-size:12px;opacity:.7">65% win rate ‚Ä¢ $3‚Äì15 per trade</div>
                <div style="font-size:12px;color:#00ff88;margin-top:3px">‚úì Low Risk ‚Ä¢ Steady Growth</div></div>
            </div>
        </div>
        <div class="bot-card" onclick="selectBot(this,'balanced')">
            <div style="display:flex;gap:14px;align-items:center">
                <span style="font-size:32px">‚öñÔ∏è</span>
                <div><div style="font-size:17px;font-weight:700;margin-bottom:3px">Balanced Bot</div>
                <div style="font-size:12px;opacity:.7">75% win rate ‚Ä¢ $10‚Äì35 per trade</div>
                <div style="font-size:12px;color:#00d9ff;margin-top:3px">‚úì Moderate Risk ‚Ä¢ Best Value</div></div>
            </div>
        </div>
        <div class="bot-card" onclick="selectBot(this,'aggressive')">
            <div style="display:flex;gap:14px;align-items:center">
                <span style="font-size:32px">üöÄ</span>
                <div><div style="font-size:17px;font-weight:700;margin-bottom:3px">Aggressive Bot</div>
                <div style="font-size:12px;opacity:.7">85% win rate ‚Ä¢ $20‚Äì80 per trade</div>
                <div style="font-size:12px;color:#fbbf24;margin-top:3px">‚úì High Risk ‚Ä¢ Max Profits</div></div>
            </div>
        </div>
        <div class="bot-card" onclick="selectBot(this,'expert')">
            <div style="display:flex;gap:14px;align-items:center">
                <span style="font-size:32px">ü§ñ</span>
                <div><div style="font-size:17px;font-weight:700;margin-bottom:3px">Expert AI Bot</div>
                <div style="font-size:12px;opacity:.7">90% win rate ‚Ä¢ $30‚Äì120 per trade</div>
                <div style="font-size:12px;color:#a855f7;margin-top:3px">‚úì AI-Powered ‚Ä¢ Premium</div></div>
            </div>
        </div>
        <button class="btn-submit" onclick="activateBot()" style="margin-top:16px">‚úÖ ACTIVATE BOT</button>
    </div>
</div>

<!-- LIVE BOT PANEL -->
<div id="livePanel">
    <h3 style="color:#00d9ff;font-size:15px;margin-bottom:14px;display:flex;align-items:center;gap:8px">
        <span style="width:8px;height:8px;background:#00ff88;border-radius:50%;display:inline-block;animation:pulse 2s infinite"></span>
        LIVE BOT ACTIVITY
    </h3>
    <div style="background:rgba(0,255,136,.1);border:1px solid rgba(0,255,136,.3);border-radius:10px;padding:10px;margin-bottom:14px">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;font-size:12px">
            <div><div style="opacity:.7">Total Trades</div><div id="totalTrades" style="font-size:18px;font-weight:700;color:#00ff88">0</div></div>
            <div><div style="opacity:.7">Total Profit</div><div id="totalProfit" style="font-size:18px;font-weight:700;color:#00ff88">+$0.00</div></div>
        </div>
    </div>
    <div id="tradesList"></div>
</div>

<script>
/* ===================== CONFIG ===================== */
const CFG = {
    MIN_DEP: 10,
    MIN_WITH: 10,
    MIN_WITH_TOTAL: 500,
    BONUS_RATE: 1.0,
    VERIFY_MS: 120000  // 2 min auto-verify
};

/* ===================== STATE ===================== */
let currentUser = null, currentEmail = '', activeAcc = 'real';
let selBot = null, selPayMethod = null;
let robotTrades = [], totalBotProfit = 0;
let activeUsers = 50123;

/* ===================== PAYMENT DATA ===================== */
const PAY_METHODS = {
    crypto: {
        label: 'Cryptocurrency (USDT TRC-20)',
        instruction: 'Send USDT via TRC-20 network to the address below. Minimum $10.',
        address: 'TQn9Y2khDD5FPFdgHRRqJQAp5xSPGfxFjt',
        note: 'Network: TRC-20 (Tron). Do NOT send on wrong network.'
    },
    mpesa: {
        label: 'M-Pesa',
        instruction: 'Send via M-Pesa to the number below. Use your email as reference.',
        address: '+254 712 345 678',
        note: 'Paybill: 247247 | Account: CRYPTOPRO'
    },
    card: {
        label: 'Credit / Debit Card',
        instruction: 'Email support@cryptopro.com with your deposit amount to receive a secure card payment link.',
        address: 'support@cryptopro.com',
        note: 'Response time: within 5 minutes.'
    },
    bank: {
        label: 'Bank Transfer',
        instruction: 'Transfer to the bank account below. Use your email as the transfer reference.',
        address: 'Account: 1234567890 | Bank: CryptoPro Bank',
        note: 'Swift/BIC: CPTOUS33 | Processing: 1‚Äì3 hours'
    }
};

/* ===================== CRYPTO DATA ===================== */
let CD = {
    'BTC/Gold':  { price: 33.612, change: 0.91, color:'#f7931a', icon:'‚Çø' },
    'BTC/USDT':  { price: 64250,  change: 1.24,  color:'#f7931a', icon:'‚Çø' },
    'ETH/USDT':  { price: 3420,   change: -0.72, color:'#627eea', icon:'Œû' },
    'BNB/USDT':  { price: 580,    change: 0.55,  color:'#f3ba2f', icon:'BNB' },
    'SOL/USDT':  { price: 145,    change: 2.10,  color:'#14f195', icon:'SOL' },
    'XAU/USDT':  { price: 2045,   change: 0.33,  color:'#ffd700', icon:'ü•á' }
};

/* ===================== ACTIVE USERS (every 60 sec) ===================== */
function refreshActiveUsers() {
    const delta = Math.floor(Math.random() * 1200) - 600;
    activeUsers = Math.max(1000, Math.min(50000, activeUsers + delta));
    const fmt = activeUsers.toLocaleString();
    ['statsUsers','heroUsers'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.textContent = id === 'heroUsers' ? fmt : fmt;
    });
}
setInterval(refreshActiveUsers, 60000);

/* ===================== LAYER ===================== */
function showLayer(id) {
    document.querySelectorAll('.layer').forEach(l => l.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    if (id === 'dashboardLayer') { refreshDash(); startPriceUpdates(); }
}

/* ===================== WINNERS TICKER ===================== */
const NAMES = ['James M.','Sarah K.','Michael R.','Emily T.','David L.','Jessica P.',
    'Robert H.','Amanda W.','Chris B.','Jennifer S.','Daniel C.','Ashley D.',
    'Matthew F.','Lisa G.','Andrew N.','Michelle V.','Joshua X.','Elizabeth Y.',
    'Kevin Z.','Patricia Q.','Brian J.','Linda U.','Steven I.','Barbara O.'];

function buildTicker() {
    const t = document.getElementById('winnersTicker');
    if (!t) return;
    let html = '';
    for (let i = 0; i < 80; i++) {
        const name = NAMES[i % NAMES.length];
        const amt  = (Math.random()*480+50).toFixed(2);
        const pair = Object.keys(CD)[Math.floor(Math.random()*Object.keys(CD).length)];
        html += `<div class="winner-item"><span>üéâ</span><span style="font-weight:600">${name}</span><span>won</span><span class="amount">+$${amt}</span><span>on ${pair}</span></div>`;
    }
    t.innerHTML = html + html;
}

/* ===================== CANDLESTICK CHART ===================== */
function makeCandleData(basePrice, n = 32) {
    const out = [];
    let p = basePrice;
    for (let i = 0; i < n; i++) {
        const bull = Math.random() > 0.44;
        const v    = basePrice * 0.018;
        const body = Math.random() * v * 0.75;
        const wT   = Math.random() * v * 0.28;
        const wB   = Math.random() * v * 0.28;
        const o    = p + (Math.random()-0.5)*v*0.5;
        const c    = bull ? o + body : o - body;
        out.push({ bull, o, c, h: Math.max(o,c)+wT, l: Math.min(o,c)-wB, vol: Math.random()*90+15 });
        p = c;
    }
    return out;
}

function renderChart(pair, candles) {
    const hi = Math.max(...candles.map(c=>c.h));
    const lo = Math.min(...candles.map(c=>c.l));
    const rng = hi - lo || 1;
    const data = CD[pair];
    const pct = pctFmt(data.change);
    const profitAmt = (data.price * Math.abs(data.change) / 100).toFixed(data.price<1?4:2);

    /* price axis labels */
    const priceLabels = Array.from({length:6},(_,i)=>
        (hi - i*(rng/5)).toFixed(data.price<10 ? 5 : data.price<100 ? 3 : 0)
    );

    /* time labels */
    const now = new Date();
    const times = Array.from({length:4},(_,i)=>{
        const d = new Date(now - (3-i)*8*60000);
        return d.getHours()+':'+(d.getMinutes().toString().padStart(2,'0'));
    });

    /* candle HTML */
    const cHTML = candles.map(c=>{
        const bodyH = Math.max((Math.abs(c.c-c.o)/rng)*100, 1.2);
        const wTH   = ((c.h - Math.max(c.o,c.c))/rng)*100;
        const wBH   = ((Math.min(c.o,c.c) - c.l)/rng)*100;
        return `<div class="candle ${c.bull?'bull':'bear'}">
            <div class="candle-wick-top" style="height:${wTH}%;min-height:2px"></div>
            <div class="candle-body" style="height:${bodyH}%"></div>
            <div class="candle-wick-bot" style="height:${wBH}%;min-height:2px"></div>
        </div>`;
    }).join('');

    /* volume HTML */
    const maxVol = Math.max(...candles.map(c=>c.vol));
    const vHTML = candles.map(c=>{
        const h = (c.vol/maxVol)*100;
        return `<div class="vol-bar ${c.bull?'bull':'bear'}" style="height:${h}%"></div>`;
    }).join('');

    return `<div class="trading-card">
        <div class="trading-header">
            <div class="pair-info">
                <div class="crypto-icon" style="background:${data.color};width:38px;height:38px;font-size:17px">${data.icon}</div>
                <div>
                    <div style="font-weight:700;font-size:17px">${pair}</div>
                    <div style="font-size:11px;opacity:.65">91% ‚Üó Payout</div>
                </div>
            </div>
            <div class="price-info">
                <div class="current-price" style="color:${data.color}">$${fmtPrice(data.price)}</div>
                <div class="price-change ${data.change>=0?'positive':'negative'}">${pct}</div>
            </div>
        </div>

        <div class="chart-wrapper">
            <!-- grid -->
            <div class="chart-grid-lines">${Array(6).fill('<div class="chart-h-line"></div>').join('')}</div>
            <div class="chart-v-lines">${Array(4).fill('<div class="chart-v-line"></div>').join('')}</div>
            <!-- profit tag -->
            <div class="profit-tag ${data.change<0?'neg':''}">üí∞ ${data.change>=0?'+':'-'}$${profitAmt}</div>
            <!-- axes -->
            <div class="price-axis">${priceLabels.map(l=>`<div>${l}</div>`).join('')}</div>
            <div class="time-axis">${times.map(t=>`<div>${t}</div>`).join('')}</div>
            <!-- candles -->
            <div class="candles-area">${cHTML}</div>
        </div>

        <div class="vol-section">
            <div class="vol-label">Volume</div>
            <div class="vol-bars">${vHTML}</div>
        </div>

        <div class="trade-btns">
            <button class="tbtn tbtn-buy" onclick="openTrade('${pair}','buy')">üü¢ BUY</button>
            <button class="tbtn tbtn-sell" onclick="openTrade('${pair}','sell')">üî¥ SELL</button>
        </div>
    </div>`;
}

function fmtPrice(p) {
    if (p < 1)   return p.toFixed(5);
    if (p < 100) return p.toFixed(3);
    return p.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2});
}

function pctFmt(v) {
    return (v>=0?'+':'')+v.toFixed(2)+'%';
}

/* ===================== RENDER MARKETS ===================== */
function renderSimpleMarkets() {
    const c = document.getElementById('marketsContainer');
    if (!c) return;
    c.innerHTML = Object.entries(CD).map(([pair,d])=>`
        <div class="simple-crypto-card">
            <div class="crypto-info">
                <div class="crypto-icon" style="background:${d.color}">${d.icon}</div>
                <div class="crypto-name">${pair}</div>
            </div>
            <div style="text-align:right">
                <div class="crypto-price">$${fmtPrice(d.price)}</div>
                <div class="asset-change ${d.change>=0?'positive':'negative'}">${pctFmt(d.change)}</div>
            </div>
        </div>`).join('');
}

function renderDashCharts() {
    const c = document.getElementById('dashMarkets');
    if (!c) return;
    c.innerHTML = Object.keys(CD).map(pair=>renderChart(pair, makeCandleData(CD[pair].price))).join('');
}

/* ===================== PRICE UPDATES ===================== */
function startPriceUpdates() {
    setInterval(()=>{
        Object.keys(CD).forEach(p=>{
            const d = CD[p];
            d.price  = Math.max(d.price*0.97, d.price + (Math.random()-0.5)*d.price*0.008);
            d.change = parseFloat(((Math.random()-0.45)*4).toFixed(2));
        });
        renderDashCharts();
        renderSimpleMarkets();
    }, 4000);
}

/* ===================== AUTH ‚Äì SIGNUP (FIXED) ===================== */
document.addEventListener('DOMContentLoaded', ()=>{

    /* --- signup form listener --- */
    const sf = document.getElementById('signupForm');
    sf && sf.addEventListener('submit', e => { e.preventDefault(); doSignup(); });

    /* --- login form listener --- */
    const lf = document.getElementById('loginForm');
    lf && lf.addEventListener('submit', e => { e.preventDefault(); doLogin(); });

    /* --- init --- */
    buildTicker();
    renderSimpleMarkets();

    /* --- restore session --- */
    const savedEmail = sessionStorage.getItem('cpEmail');
    if (savedEmail) {
        const users = getUsers();
        if (users[savedEmail]) {
            currentUser  = users[savedEmail];
            currentEmail = savedEmail;
            robotTrades  = currentUser.botTrades || [];
            totalBotProfit = currentUser.botProfit || 0;
            showLayer('dashboardLayer');
            checkPending();
            if (currentUser.selBot !== 'none') startBot();
        }
    }
});

function doSignup() {
    const btn = document.getElementById('signupBtn');
    btn.disabled = true;
    btn.textContent = '‚è≥ Creating‚Ä¶';

    const name  = v('signupName');
    const email = v('signupEmail').toLowerCase();
    const phone = v('signupPhone');
    const pass  = v('signupPassword');
    const conf  = v('signupConfirm');
    const terms = document.getElementById('signupTerms').checked;

    const reset = (msg, type)=>{
        showAlert('signupAlert', msg, type);
        btn.disabled = false;
        btn.textContent = 'üöÄ Create Account';
    };

    if (!name || !email || !phone || !pass) return reset('Please fill in all fields.','error');
    if (pass.length < 6)                    return reset('Password must be at least 6 characters.','error');
    if (pass !== conf)                      return reset('Passwords do not match.','error');
    if (!terms)                             return reset('Please accept the Terms & Conditions.','error');

    const users = getUsers();
    if (users[email]) return reset('Email already registered. Please login.','error');

    users[email] = {
        name, email, phone, password: pass,
        demoBalance: 10000, realBalance: 0, displayBalance: 0,
        totalDeposited: 0, botTrades: [], botProfit: 0,
        selBot: 'none', bonusGiven: false, pendingDeps: [],
        createdAt: new Date().toISOString()
    };
    saveUsers(users);

    showAlert('signupAlert','‚úÖ Account created! Redirecting to login‚Ä¶','success');
    setTimeout(()=>{
        document.getElementById('signupForm').reset();
        btn.disabled = false;
        btn.textContent = 'üöÄ Create Account';
        showLayer('loginLayer');
    }, 2000);
}

/* ===================== AUTH ‚Äì LOGIN ===================== */
function doLogin() {
    const email = v('loginEmail').toLowerCase();
    const pass  = v('loginPassword');
    if (!email || !pass) return showAlert('loginAlert','Enter email and password.','error');

    const users = getUsers();
    if (!users[email])           return showAlert('loginAlert','Account not found. Please sign up.','error');
    if (users[email].password !== pass) return showAlert('loginAlert','Incorrect password.','error');

    currentUser  = users[email];
    currentEmail = email;
    sessionStorage.setItem('cpEmail', email);

    showAlert('loginAlert','‚úÖ Login successful! Loading dashboard‚Ä¶','success');
    setTimeout(()=>{
        document.getElementById('loginForm').reset();
        showLayer('dashboardLayer');
        checkPending();
    }, 1400);
}

/* ===================== LOGOUT ===================== */
function handleLogout() {
    if (!confirm('Log out?')) return;
    sessionStorage.clear();
    currentUser = null; currentEmail = '';
    document.getElementById('livePanel').classList.remove('show');
    showLayer('welcomeLayer');
}

/* ===================== DASHBOARD ===================== */
function refreshDash() {
    if (!currentUser) return;
    document.getElementById('userName').textContent   = currentUser.name;
    document.getElementById('userEmail').textContent  = currentUser.email;
    const bal = activeAcc === 'demo' ? currentUser.demoBalance : currentUser.displayBalance;
    document.getElementById('dashBalance').textContent = '$' + bal.toFixed(2);
    renderDashCharts();
    if (currentUser.selBot !== 'none') {
        document.getElementById('livePanel').classList.add('show');
        refreshLivePanel();
    }
}

function switchAccount(type) {
    activeAcc = type;
    document.getElementById('demoBtn').classList.toggle('active', type==='demo');
    document.getElementById('realBtn').classList.toggle('active', type==='real');
    refreshDash();
}

/* ===================== DEPOSIT ===================== */
function choosePayment(method, el) {
    selPayMethod = method;
    document.querySelectorAll('.pay-card').forEach(c=>c.classList.remove('chosen'));
    el.classList.add('chosen');

    const m = PAY_METHODS[method];
    document.getElementById('payInstruction').textContent = m.instruction;
    document.getElementById('payAddress').textContent     = m.address;
    document.getElementById('payNote').textContent        = m.note;
    document.getElementById('payDetailBox').classList.add('visible');
    document.getElementById('depositSubmitBtn').disabled = false;
}

function processDeposit() {
    const amt = parseFloat(document.getElementById('depositAmount').value);
    const ref = document.getElementById('depositRef').value.trim();

    if (!amt || amt < CFG.MIN_DEP) { alert('‚ùå Minimum deposit is $' + CFG.MIN_DEP); return; }
    if (!selPayMethod)             { alert('‚ùå Please select a payment method.'); return; }
    if (!ref)                      { alert('‚ùå Please enter your transaction reference.'); return; }

    const dep = {
        id: Date.now()+'', amt, method: selPayMethod,
        ref, proof: document.getElementById('depositProof').value.trim(),
        ts: new Date().toISOString(), status: 'pending'
    };
    if (!currentUser.pendingDeps) currentUser.pendingDeps = [];
    currentUser.pendingDeps.push(dep);
    persist();
    closeModal('depositModal');

    alert(`‚úÖ Deposit submitted!\n\nAmount: $${amt.toFixed(2)}\nMethod: ${PAY_METHODS[selPayMethod].label}\nReference: ${ref}\n\n‚è± Funds will appear automatically in 1‚Äì5 minutes.\nIf not received after 5 minutes, upload your screenshot.`);

    /* Auto-verify after 2 minutes */
    setTimeout(()=>verifyDep(dep.id), CFG.VERIFY_MS);
}

function checkPending() {
    (currentUser.pendingDeps||[]).forEach(d=>{
        if (d.status==='pending' && Date.now()-new Date(d.ts).getTime() >= CFG.VERIFY_MS)
            verifyDep(d.id);
    });
}

function verifyDep(id) {
    const d = (currentUser.pendingDeps||[]).find(x=>x.id===id);
    if (!d || d.status!=='pending') return;

    let bonus = 0;
    if (!currentUser.bonusGiven) { bonus = d.amt * CFG.BONUS_RATE; currentUser.bonusGiven = true; }
    const total = d.amt + bonus;

    currentUser.displayBalance += total;
    currentUser.realBalance    += total;
    currentUser.totalDeposited += d.amt;
    d.status = 'verified';
    persist();
    refreshDash();

    if (sessionStorage.getItem('cpEmail')) {
        const msg = bonus > 0
            ? `üéâ Deposit Verified!\n\nDeposit: $${d.amt.toFixed(2)}\nüéÅ Bonus: +$${bonus.toFixed(2)}\nüí∞ Total: $${total.toFixed(2)}\n\nFunds are now in your account!`
            : `‚úÖ Deposit Verified!\n\n$${d.amt.toFixed(2)} added to your account!`;
        alert(msg);
    }
}

/* ===================== WITHDRAW ===================== */
function processWithdraw() {
    const amt  = parseFloat(document.getElementById('withdrawAmount').value);
    const acct = document.getElementById('withdrawAccount').value.trim();
    if (!amt || amt < CFG.MIN_WITH) { alert('Minimum withdrawal: $'+CFG.MIN_WITH); return; }

    const bal = activeAcc==='demo' ? currentUser.demoBalance : currentUser.displayBalance;
    if (amt > bal) { alert('Insufficient balance.\n\nAvailable: $'+bal.toFixed(2)); return; }

    if (currentUser.totalDeposited < CFG.MIN_WITH_TOTAL) {
        const need = CFG.MIN_WITH_TOTAL - currentUser.totalDeposited;
        alert(`‚ö†Ô∏è Withdrawal Locked\n\nYou need $${need.toFixed(2)} more in deposits to unlock withdrawals.\n\nTotal needed: $${CFG.MIN_WITH_TOTAL}`);
        return;
    }
    if (!acct) { alert('Please enter account details.'); return; }

    if (activeAcc==='demo') currentUser.demoBalance    -= amt;
    else                    currentUser.displayBalance -= amt;
    persist(); refreshDash(); closeModal('withdrawModal');
    alert(`‚úÖ Withdrawal of $${amt.toFixed(2)} submitted.\n\nProcessing: 1‚Äì24 hours.`);
}

/* ===================== TRADE ===================== */
function openTrade(pair, type) {
    document.getElementById('tradePair').value = pair;
    document.getElementById('tradeType').value = type==='buy' ? 'üü¢ BUY (Long)' : 'üî¥ SELL (Short)';
    showModal('tradeModal');
}

function executeTrade() {
    const amt  = parseFloat(document.getElementById('tradeAmount').value);
    const pair = document.getElementById('tradePair').value;
    if (!amt || amt < 10) { alert('Minimum trade: $10'); return; }

    const bal = activeAcc==='demo' ? currentUser.demoBalance : currentUser.displayBalance;
    if (amt > bal) { alert('Insufficient balance.\n\nAvailable: $'+bal.toFixed(2)); return; }

    const win    = Math.random() < 0.6;
    const profit = amt * (Math.random()*0.05) * (win?1:-1);
    if (activeAcc==='demo') currentUser.demoBalance    += profit;
    else                    currentUser.displayBalance += profit;

    persist(); refreshDash(); closeModal('tradeModal');
    alert(`${win?'‚úÖ Trade Won!':'‚ùå Trade Lost'}\n\nPair: ${pair}\nAmount: $${amt.toFixed(2)}\nP&L: ${profit>=0?'+':''}$${profit.toFixed(2)}\nNew Balance: $${(bal+profit).toFixed(2)}`);
}

/* ===================== BOT ===================== */
function selectBot(el, type) {
    selBot = type;
    document.querySelectorAll('.bot-card').forEach(c=>c.classList.remove('selected'));
    el.classList.add('selected');
}

function activateBot() {
    if (!selBot) { alert('Please select a bot first.'); return; }
    currentUser.selBot = selBot;
    persist();
    closeModal('botModal');
    document.getElementById('livePanel').classList.add('show');
    alert(`‚úÖ ${selBot.charAt(0).toUpperCase()+selBot.slice(1)} Bot activated!\n\nThe bot is now trading automatically.`);
    startBot();
}

function startBot() {
    const profiles = {
        conservative:{ min:3,  max:15,  rate:.65 },
        balanced:    { min:10, max:35,  rate:.75 },
        aggressive:  { min:20, max:80,  rate:.85 },
        expert:      { min:30, max:120, rate:.90 }
    };
    setInterval(()=>{
        if (!currentUser || currentUser.selBot==='none' || activeAcc!=='real') return;
        const p   = profiles[currentUser.selBot];
        const win = Math.random() < p.rate;
        const pl  = win ? (p.min + Math.random()*(p.max-p.min)) : -(p.min*0.3);
        currentUser.displayBalance += pl;
        totalBotProfit             += pl;
        currentUser.botProfit      = totalBotProfit;

        const pair = Object.keys(CD)[Math.floor(Math.random()*Object.keys(CD).length)];
        robotTrades.unshift({ pair, pl, time: new Date().toISOString(), bot: currentUser.selBot });
        if (robotTrades.length > 25) robotTrades = robotTrades.slice(0,25);
        currentUser.botTrades = robotTrades;

        persist(); refreshDash(); refreshLivePanel();
    }, 15000);
}

function refreshLivePanel() {
    document.getElementById('totalTrades').textContent = robotTrades.length;
    const pe = document.getElementById('totalProfit');
    pe.textContent = (totalBotProfit>=0?'+':'')+'$'+totalBotProfit.toFixed(2);
    pe.style.color = totalBotProfit>=0 ? '#00ff88' : '#ff006e';

    const list = document.getElementById('tradesList');
    list.innerHTML = robotTrades.slice(0,12).map(t=>{
        const col = t.pl>0 ? '#00ff88':'#ff006e';
        return `<div class="trade-item" style="border-left-color:${col}">
            <div style="display:flex;justify-content:space-between;margin-bottom:3px">
                <strong style="color:${CD[t.pair]?.color||'#fff'}">${t.pair}</strong>
                <span style="color:${col};font-weight:700">${t.pl>0?'+':''}$${t.pl.toFixed(2)}</span>
            </div>
            <div style="font-size:11px;opacity:.65;display:flex;justify-content:space-between">
                <span>${t.bot} bot</span>
                <span>${new Date(t.time).toLocaleTimeString()}</span>
            </div>
        </div>`;
    }).join('') || '<div style="text-align:center;padding:18px;opacity:.5;font-size:13px">No trades yet‚Ä¶</div>';
}

/* ===================== MODAL ===================== */
function showModal(id) { document.getElementById(id).classList.add('active'); }

function closeModal(id) {
    document.getElementById(id).classList.remove('active');
    if (id === 'depositModal') {
        selPayMethod = null;
        document.querySelectorAll('.pay-card').forEach(c=>c.classList.remove('chosen'));
        document.getElementById('payDetailBox').classList.remove('visible');
        document.getElementById('depositSubmitBtn').disabled = true;
        document.getElementById('depositAmount').value = '';
        document.getElementById('depositRef').value    = '';
        document.getElementById('depositProof').value  = '';
    }
}

/* ===================== ALERTS ===================== */
function showAlert(id, msg, type) {
    const el = document.getElementById(id);
    el.textContent = msg;
    el.className = `alert alert-${type} show`;
    if (type === 'error') setTimeout(()=>el.classList.remove('show'), 5000);
}

/* ===================== STORAGE ===================== */
function getUsers()      { return JSON.parse(localStorage.getItem('cpUsers')||'{}'); }
function saveUsers(u)    { localStorage.setItem('cpUsers', JSON.stringify(u)); }
function persist()       {
    if (!currentEmail || !currentUser) return;
    const u = getUsers();
    u[currentEmail] = currentUser;
    saveUsers(u);
}
function v(id) { return (document.getElementById(id)||{}).value?.trim()||''; }
</script>
</body>
</html>
